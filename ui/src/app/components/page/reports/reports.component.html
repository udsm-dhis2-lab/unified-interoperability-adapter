<div class="row">
  <div class="col-12">
    <div class="row">
      <div class="col-12">
        <div class="mb-3">
          <h3 class="text-">Reports</h3>
        </div>
      </div>
    </div>
    <form action="row">
      <div class="row">
        <div class="col-12">
          <div
            class="alert alert-{{ messageType }} alert-dismissible fade show"
            *ngIf="message && viewDatasetReport"
            role="alert"
          >
            {{ message }}
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="alert"
              aria-label="Close"
            ></button>
          </div>
        </div>
      </div>
      <div class="form-group row">
        <div class="col-3">
          <mat-form-field class="mt-control">
            <mat-label>Instance: </mat-label>
            <mat-select
              [(ngModel)]="instance"
              name="instance"
              (selectionChange)="filterDatasets()"
            >
              <mat-option></mat-option>
              <mat-option *ngFor="let instance of instances" [value]="instance">
                {{ instance.name }}
              </mat-option>
            </mat-select>
          </mat-form-field>
          <div *ngIf="message && !instance && !viewDatasetReport">
            <p class="text-danger">
              {{ message }}
            </p>
          </div>
        </div>
        <div class="col-3">
          <mat-form-field class="mt-control">
            <mat-label>Linked Datasets: </mat-label>
            <mat-select
              [(ngModel)]="dataset"
              name="dataset"
              (selectionChange)="checkDataset(dataset!)"
            >
              <mat-option></mat-option>
              <mat-option *ngFor="let dataset of datasets" [value]="dataset">
                {{ dataset.displayName }}
              </mat-option>
            </mat-select>
          </mat-form-field>
          <div *ngIf="message && !dataset && !viewDatasetReport">
            <p class="text-danger">
              {{ message }}
            </p>
          </div>
        </div>
        <div class="col-3">
          <mat-form-field class="mt-control">
            <mat-label>Period: </mat-label>
            <mat-select
              [(ngModel)]="periodValue"
              name="period"
              (selectionChange)="this.viewDatasetReport = false"
            >
              <mat-option> </mat-option>
              <mat-option *ngFor="let period of periods" [value]="period.value">
                {{ period.name }}
              </mat-option>
            </mat-select>
          </mat-form-field>
          <div *ngIf="message && !periodValue && !viewDatasetReport">
            <p class="text-danger">
              {{ message }}
            </p>
          </div>
        </div>
        <div class="col-3 mt-4">
          <app-button
            [ngStyle]="{
              padding: '90px',
              margin: '20px 0 0 -2vw'
            }"
            backgroundColor="transparent"
            fontColor="green"
            borderColor="green"
            text="View Report"
            (click)="viewReport()"
          >
          </app-button>
        </div>
      </div>
    </form>
    <div class="row mt-5" *ngIf="viewDatasetReport">
      <div class="col-12">
        <app-dataset-view-form
          [isDataEntryLevel]="true"
          [presetValuesSections]="[]"
          [dataSetFormDesign]="dataset?.formDesignCode"
          [dataSetDataValues]="{}"
          [dataset]="dataset"
          [datasetValues]="datasetValues"
          [sendingObject]="sendingObject"
        >
        </app-dataset-view-form>
      </div>
    </div>
  </div>
</div>
